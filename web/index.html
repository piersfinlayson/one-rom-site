<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/style.css">
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />

    <!-- SEO title & description -->
    <title>One ROM Web</title>
    <meta name="description" content="Web-based programmer for One ROM USB - the most flexible retro ROM replacement">
    <link rel="canonical" href="https://onerom.org/web/" />

    <!-- Open Graph for social media -->
    <meta property="og:url" content="https://onerom.org/web/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="One ROM Web | piers.rocks">
    <meta property="og:description" content="Web-based programmer for One ROM USB - the most flexible retro ROM replacement">
    <meta property="og:image" content="/images/one-rom/one%20rom%20image%20social.png">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="onerom.org">
    <meta property="twitter:url" content="https://onerom.org/web/">
    <meta name="twitter:title" content="One ROM Web | piers.rocks">
    <meta name="twitter:description" content="Web-based programmer for One ROM USB - the most flexible retro ROM replacement">
    <meta name="twitter:image" content="/images/one-rom/one%20rom%20image%20social.png">

    <!-- Script which contains the WebUSB DFU functions -->
    <script src="/js/prog/usbDfuDevice.js"></script>

    <!-- Picoboot library for RP2350 (Fire) -->
    <script type="module">
        import { Picoboot } from 'https://picoflash.org/pkg/picoboot.js';
        window.Picoboot = Picoboot;  // Make it globally available
    </script>

    <script src="/js/prog/unifiedProgrammer.js"></script>
</head>

<!-- Page HTML content -->

<body>
    <div class="app">

        <!-- Title -->
        <div style="display: flex; justify-content: space-between; align-items: flex-start; padding-bottom: 0rem; border-bottom: 1px solid var(--border-color);">
            <h1 style="margin-bottom: 0; border-bottom: none;">One R<span class="o-in-rom">O</span>M Web</h1>
            <div style="display: flex; gap: 1rem;">
                <a href="/studio/" class="gold-button"><span class="michroma">Studio</span></a>
                <a href="/" class="gold-button"><span class="michroma">Home</span></a>
            </div>
        </div>
        <p>
            Supports Fire and Ice One ROMs.  Works on Windows, Mac, Linux and Android.
        </p>
        <p>
            Use <a href="https://www.google.com/chrome/">Chrome</a>, <a href="https://www.microsoft.com/en-gb/edge/">Edge</a>, or another <a href="https://www.chromium.org/">Chromium</a> based browser. See <a href="#usage">Usage</a> for instructions.
        </p>

        <hr>

        <!-- Device Connection Section -->
        <div class="device-section">
            <h2>Device Information</h2>
            <div class="buttons-and-bar">
                <button class="gold-button" id="connectBtn">Connect</button>
                <progress id="connectProgressBar" value="0" max="100"></progress>
            </div>
            
            <!-- Device Summary (shown after connection) -->
            <div class="info-summary hidden" id="deviceSummary">
                <div class="info-row">
                    <span class="info-label">Device Status:</span>
                    <span id="deviceStatus"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">Firmware Version:</span>
                    <span id="deviceVersion"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">MCU:</span>
                    <span id="deviceMcu"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">PCB Revision:</span>
                    <span id="devicePcbRevision"></span>
                </div>
                <div class="info-row">
                    <span class="info-label">Current ROMs:</span>
                    <span id="deviceConfig"></span>
                </div>
            </div>

            <!-- Expandable Device Details -->
            <details class="hidden" id="deviceDetails">
                <summary>Device Firmware Details</summary>
                <div class="firmware-details" id="deviceDetailsContent"></div>
            </details>
        </div>

        <hr>

        <!-- Firmware Source Selection -->
        <div class="firmware-section">
            <h2>Programming</h2>

            <!-- Update tab navigation to include Pre-built -->
            <div class="tab-navigation">
                <button class="tab-button active" data-tab="prebuilt">Pre-built Image</button>
                <button class="tab-button" data-tab="custom">Custom Image</button>
                <button class="tab-button" data-tab="file">Local Image</button>
                <button class="tab-button" data-tab="url">URL Image</button>
            </div>

            <div class="tab-content-container">
                <div class="entry-boxes">
                    <!-- URL tab -->
                    <div class="tab-input" data-tab="url">
                        <p style="margin-top: 0rem; margin-bottom: 1rem;">
                            Program One ROM with a One ROM firmware binary hosted online.
                        </p>
                        <select id="mcuSelectUrl" class="mcu-select">
                            <option value="">MCU Variant</option>
                            <option value="F401RB">F401RB</option>
                            <option value="F401RC">F401RC</option>
                            <option value="F401RE">F401RE</option>
                            <option value="F405RG">F405RG</option>
                            <option value="F411RC">F411RC</option>
                            <option value="F411RE">F411RE</option>
                            <option value="F446RC">F446RC</option>
                            <option value="F446RE">F446RE</option>
                            <option value="RP2350">RP2350</option>
                        </select>
                        <input id="fileLocationBox" type="url" placeholder="https://onerom.org/rom/firmware.bin" style="flex-grow: 1; width: 45ch;">
                    </div>
                    
                    <!-- Local File tab -->
                    <div class="tab-input" data-tab="file" style="display: none;">
                        <p style="margin-top: 0rem; margin-bottom: 1rem;">
                            Program One ROM with a One ROM firmware binary stored on your computer.
                        </p>
                        <select id="mcuSelectFile" class="mcu-select">
                            <option value="">MCU Variant</option>
                            <option value="F401RB">F401RB</option>
                            <option value="F401RC">F401RC</option>
                            <option value="F401RE">F401RE</option>
                            <option value="F405RG">F405RG</option>
                            <option value="F411RC">F411RC</option>
                            <option value="F411RE">F411RE</option>
                            <option value="F446RC">F446RC</option>
                            <option value="F446RE">F446RE</option>
                            <option value="RP2350">RP2350</option>
                        </select>
                        <label for="fileUploadBox" class="file-button">Choose Firmware File</label>
                        <span id="fileName" style="margin-left: 0.5rem; color: var(--text-secondary);">No file selected</span>
                        <input id="fileUploadBox" type="file" accept=".bin" style="display: none;">
                    </div>

                    <!-- Custom Image tab -->
                    <div class="tab-input" data-tab="custom">
                        <p style="margin-top: 0rem; margin-bottom: 1rem;">
                            Program One ROM with a single ROM binary image that you upload. For more complex configurations, use <a href="/studio/" target="_blank">One ROM Studio</a> and a <a href="https://github.com/piersfinlayson/one-rom/blob/main/rom-config/README.md" target="_blank">ROM config JSON file</a>.
                        </p>

                        <div class="custom-image-container">
                            <!-- Left Column: Device Selection -->
                            <div class="custom-left">
                                <h3>Device Configuration</h3>
                                
                                <div class="select-row">
                                    <label>Model:</label>
                                    <select id="customModelSelect">
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                
                                <div class="select-row">
                                    <label>PCB Revision:</label>
                                    <select id="customPcbSelect" disabled>
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                
                                <div class="select-row">
                                    <label>MCU Variant:</label>
                                    <select id="customMcuSelect" disabled>
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                
                                <div class="select-row">
                                    <label>Firmware Version:</label>
                                    <select id="customVersionSelect" disabled>
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Right Column: ROM Configuration -->
                            <div class="custom-right">
                                <h3>ROM Configuration</h3>

                                <label for="customRomFile" class="file-button" style="margin-top: 0rem; margin-bottom: 0.5rem;">Upload ROM Image</label>
                                <span id="customRomFileName">No file selected</span>
                                <input id="customRomFile" type="file" accept=".bin,.rom" style="display: none;">

                                <div class="select-row">
                                    <label>ROM Type:</label>
                                    <select id="customRomTypeSelect" disabled>
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                
                                <div class="select-row custom-cs-row" id="customCs1Row">
                                    <label>CS1 Logic:</label>
                                    <select id="customCs1Select">
                                        <option value="">Required</option>
                                        <option value="active_low">Active Low</option>
                                        <option value="active_high">Active High</option>
                                    </select>
                                </div>
                                
                                <div class="select-row custom-cs-row" id="customCs2Row">
                                    <label>CS2 Logic:</label>
                                    <select id="customCs2Select">
                                        <option value="">Required</option>
                                        <option value="active_low">Active Low</option>
                                        <option value="active_high">Active High</option>
                                    </select>
                                </div>
                                
                                <div class="select-row custom-cs-row" id="customCs3Row">
                                    <label>CS3 Logic:</label>
                                    <select id="customCs3Select">
                                        <option value="">Required</option>
                                        <option value="active_low">Active Low</option>
                                        <option value="active_high">Active High</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Build and Save buttons -->
                        <div style="margin-top: 1rem;">
                            <button id="customBuildBtn" class="gold-button" disabled>Build Firmware</button>
                            <button id="customSaveBtn" class="gold-button" disabled>Save Firmware</button>
                        </div>
                    </div>

                    <!-- Pre-built Images tab -->
                    <div class="tab-input" data-tab="prebuilt" style="display: none;">
                        <p style="margin-top: 0rem; margin-bottom: 1rem;">
                            Program a One ROM from a pre-built collection of ROM images.
                        </p>

                        <div id="prebuiltLoading">Loading releases...</div>
                        <div id="prebuiltSelectors" style="display: none;">
                            <div class="select-row">
                                <label>Model:</label>
                                <select id="modelSelect">
                                    <option value="">Model</option>
                                </select>
                            </div>
                            
                            <div class="select-row">
                                <label>PCB Revision:</label>
                                <select id="hwRevSelect" disabled>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            
                            <div class="select-row">
                                <label>MCU Variant:</label>
                                <select id="mcuSelectPrebuilt" disabled>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            
                            <div class="select-row">
                                <label>Firmware Version:</label>
                                <select id="versionSelect" disabled>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                            
                            <div class="select-row">
                                <label>ROM Config:</label>
                                <select id="romConfigSelect" disabled>
                                    <option value="">Select...</option>
                                </select>
                            </div>
                        </div>
                        <div id="configDescription" class="config-description"></div>
                    </div>
                </div>
                
                <div class="buttons-and-bar">
                    <button id="connectProgramButton" class="gold-button">Program</button>
                    <progress id="progressBar" value="0" max="100"></progress>
                </div>
            </div>

        </div>

        <hr>

        <div class="usage">
            <details id="usage">
                <summary>Usage</summary>
                <ol>
                    <li>First time setup:
                        <ul>
                            <li><a href="#windows">Windows</a></li>
                            <li><a href="#linux">Linux</a></li>
                            <li>Mac - not required</li>
                            <li>Android - not required</li>
                        </ul>
                    </li>
                    <li>Plug in your One ROM USB.  If this is a factory fresh One ROM USB jump the B0 and 3V3 pads on the underside while plugging it in.  If the red LED doesn't light up faintly, try again.</li>
                    <li>Click the "Connect" button.  A popup will appear asking you to select a device. Select "RP2350 Boot" (Fire) or "STM32 BOOTLOADER" (Ice) and click "Connect".  On Android you may receive another pop-up asking you to confirm the browser's USB access.</li>
                    <li>The device's current firmware will be read and analyzed, with information being displayed once complete.</li>
                    <li>Choose the firmware source: Pre-built, Custom, Local or URL.</li>
                    <li>(Ice only) Select the MCU variant you are programming, and in the case of the pre-built image, your PCB revision and desired One ROM firmware version.  If an ONE ROM firmware was detected on the device you can use the values displayed.  On Fire, RP2350 will be pre-selected.</li>
                    <li>Choose a pre-built config, upload and configure the ROM image, select a local firmware file, or enter the URL of the firmware file to program.</li>
                    <li>Click the "Program" button.</li>
                    <li>The button text will change to "Erasing". Wait for this to complete.</li>
                    <li>The button text will change to "Programming". Wait for this to complete.</li>
                    <li>When done, the device will be re-analyzed to verify the programming operation.  Once complete, you can disconnect One ROM and plug it into your retro system.</li>
                </ol>
            </details>
        </div>

        <div class="problems">
            <details id="problems">
                <summary>Problems</summary>
                <p>
                    If you encounter any issues using this programmer, <a href="#" id="githubIssueLink1" target="_blank">raise a GitHub issue</a>.
                </p>
            </details>
        </div>

        <div class="faq">
            <details id="faq">
                <summary>FAQ</summary>
                <ul>
                    <ul><strong>Q: What if I hit problems?</strong></ul>
                    <ul><strong>A:</strong> <a href="#" id="githubIssueLink" target="_blank">Raise a GitHub issue</a>.</ul>
                    <ul><strong>Q: Why do I have to select the STM32 variant?</strong></ul>
                    <ul><strong>A:</strong> So the programmer can ensure the firmware you provided is for your specific STM32 chip, and that your One ROM USB has enough flash space for the firmware image.</ul>
                    <ul><strong>Q: How do I know what STM32 variant my One ROM has?</strong></ul>
                    <ul><strong>A:</strong> Read the part number from One ROM's main IC.  You are looking for the 6 characters immediately after "STM32".</ul>
                    <ul><strong>Q: Why isn't there a pre-built image for my system?</strong></ul>
                    <ul><strong>A:</strong> Either build it yourself using the <a href="https://github.com/piersfinlayson/one-rom">One ROM github repo</a>, or <a href="#" id="githubIssueLink3" target="_blank">raise a GitHub issue</a> letting us know where we can find the ROM image(s) you want One ROM to serve.</ul>
                    <ul><strong>Q: Why isn't my STM32 variant listed?</strong></ul>
                    <ul><strong>A:</strong> Pre-built images are available for the most commonly used STM32 variants.  You can build images for other variants using the <a href="https://github.com/piersfinlayson/one-rom">One ROM github repo</a>.</ul>
                    <ul><strong>Q: Can I use this with Firefox, Safari, or another non-Chromium browser?</strong></ul>
                    <ul><strong>A:</strong> WebUSB, the technology behind this programmer, is only supported in Chromium based browsers like Chrome and Edge.</ul>
                    <ul><strong>Q: Can I use this on Linux or Mac?</strong></ul>
                    <ul><strong>A:</strong> Yes, but you must still use a Chromium based browser.</ul>
                    <ul><strong>Q: Can I use this with a non-USB version of One ROM?</strong></ul>
                    <ul><strong>A:</strong> This programmer currently only works with the USB version of One ROM.</ul>
                    <ul><strong>Q: Can I use this to program other, non-One ROM, STM32 devices?</strong></ul>
                    <ul><strong>A:</strong> This programmer only programs valid One ROM USB firmware - it checks the image before programming.  However, the site is based on generic STM32 DFU and RP2350 PICOBOOT implementations, and the code is MIT licensed, so you are free to copy and modify it for your own purposes.  For the RP2040/RP2350 see <a href="https://picoflash.org" target="_blank">picoflash.org</a>, which is a generic implementation.</ul>
                    <ul><strong>Q: Can I use this on my phone or tablet?</strong></ul>
                    <ul><strong>A:</strong> Yes, on an Android device using Chrome.  One ROM Web does not work on iPhone or iPad due to Apple's restrictive approach towards USB devices.</ul>
                    <ul><strong>Q: Is my privacy protected?</strong></ul>
                    <ul><strong>A:</strong> We do not collect any personal data. We use <a href="https://www.goatcounter.com/" target="_blank">GoatCounter</a> for privacy-friendly analytics.</ul>
                    <ul><strong>Q: Where can I find the source code for this programmer?</strong></ul>
                    <ul><strong>A:</strong> The <a href="https://github.com/piersfinlayson/one-rom-site" target="_blank">github repo</a>.</ul>
                    <ul><strong>Q: When I press "Connect" why does it sometimes read the One ROM twice?</strong></ul>
                    <ul><strong>A:</strong> Firmware versions prior to v0.5.0 stored the ROM metadata in a different location on flash.  This tool attempts to read just the first 64KB (metadata location for v0.5.0+) and if the ROM metadata is not present, then re-reads the entire flash to find it.</ul>
                </ul>
            </details>
        </div>

        <div class="windows">
            <details id="windows">
                <summary>Windows Setup</summary>
                <p>These steps should not be required for Fire boards.</p>
                <ol>
                    <li>Download and install <a href="https://zadig.akeo.ie/" target="_blank">Zadig</a>.</li>
                    <li>Plug in your One ROM USB.  If this is a factory fresh One ROM USB, jump the B0 and 3V3 pads on the underside while plugging it in.  If the red LED doesn't light up faintly, try again.</li>
                    <li>In Zadig, select "Options" &gt; "List All Devices".</li>
                    <li>In the dropdown, select "STM32 BOOTLOADER".</li>
                    <li>From the driver selection box on the right of the big green arrow, select "WinUSB (some version number)".</li>
                    <li>Click "Install Driver". If it says "Replace Driver" or "Reinstall Driver", click that instead.</li>
                </ol>
                <p><img src="images/zadig-1.png" alt="Zadig showing STM32 BOOTLOADER selected with WinUSB driver ready to install" style="width: 75%;"></p>
                <ol start="7">
                    <li>Wait for the installation to complete.  It may take a few seconds for the progress pop-up to appear.</li>
                </ol>
                <p><img src="images/zadig-2.png" alt="Zadig driver installation progress bar" style="width: 50%;"></p>
                <p><img src="images/zadig-3.png" alt="Zadig driver installation successful completion dialog" style="width: 50%;"></p>
                <ol start="8">
                    <li>You can now close Zadig.</li>
                </ol>
            </details>
        </div>

        <div class="linux">
            <details id="linux">
                <summary>Linux Setup</summary>
                <ol>
                    <li>
                        Create a file called <code>/etc/udev/rules.d/51-one-rom.rules</code> with the following content:
                        <pre><code>SUBSYSTEM=="usb", ATTRS{idVendor}=="0483", MODE="0666"</code></pre>
                        <pre><code>SUBSYSTEM=="usb", ATTRS{idVendor}=="2e8a", MODE="0666"</code></pre>
                    </li>
                    <li>
                        Then run:
                        <pre><code>sudo udevadm control --reload-rules
sudo udevadm trigger</code></pre>
                    </li>
                    <li>
                        If you are using Chromium installed via snap, you need to allow Chromium to use USB by running:
                        <pre><code>snap connect chromium:raw-usb</code></pre>
                        Then restart Chromium.
                    </li>
                </ol>
            </details>
        </div>

        <div class="technical">
            <details id="technical">
                <summary>How It Works</summary>
                <ul>
                    <li>The page uses <a href="https://en.wikipedia.org/wiki/WebUSB" target="_blank">WebUSB</a> to access One ROM USB directly from your browser.</li>
                    <li>One ROM firmware parsing and building routines are run using <a href="https://wasm.onerom.org/" target="_blank">Web Assembly</a> directly within your browser.</li>
                    <li>For security reasons, WebUSB is only available when this site is served over HTTPS (or from localhost) - you are recommended to use it at <a href="https://onerom.org/web/" target="_blank">https://onerom.org/web/</a>.  This version is built directly from the main branch of the One ROM website's github repository, and served by GitHub.</li>
                    <li>Only the device you select when you hit "Connect" or "Program" can be accessed by this page's javascript code - your other USB devices are not visible to it.  None of your devices, including your chosen one, are visible to the server.</li>
                    <li>The page's javascript code implements the STM32 DFU and RP2350 PICOBOOT protocols, performing the necessary flash load, erase and programming operations on your One ROM USB.</li>
                    <li>The firmware on your One ROM USB can only be updated when it is in programming mode.  This is automatically enabled when you plug in One ROM to a USB host, like a PC, unless you have a completely "fresh from the factory", or bricked, One ROM USB.</li>
                    <li style="list-style-type: none;">If you have factory fresh, or bricked, One ROM USB, you need to manually put it into programming mode before flashing, by jumping B0 and 3V3 (Ice) or B and GND (Fire) on the underside of One ROM, while plugging it into USB.</li>
                    <li style="list-style-type: none;">One ROM's status LED is lit dimly when in programming mode.</li>
                </ul>
            </details>
        </div>

        <div class="privacy">
            <details id="privacy">
                <summary>Privacy</summary>
                <p>
                    One ROM Web is hosted and served by GitHub Pages.  It retrieves One ROM firmware manifest information from GitHub.  GitHub may log your browser details and IP address.
                </p>
                <p>
                    Most of the site's functionality runs entirely in your browser, and no personally identifiable data is stored by any server other than the GitHub pages server:
                    <ul>
                        <li>When your browser loads this page, it tests whether a piers.rocks server is responding, and enables the pre-built image functionality if so.  The piers.rocks server logs your browser's User-Agent string (which typically includes your OS and browser version) and the firmware file being downloaded, but <strong>does not</strong> log any personally identifiable information like your IP address.</li>
                        <li>If you flash a pre-built image, the image is downloaded from GitHub via a piers.rocks server.  This is done to work around javasript limitations when retrieving GitHub release artifacts.  The piers.rocks server logs your browser's User-Agent string (which typically includes your OS and browser version) and the firmware file being downloaded, but <strong>does not</strong> log any personally identifiable information like your IP address.</li>
                        <li>If you flash a local file, it is read directly from your computer, and not sent to any server.</li>
                        <li>If you flash an image from a URL, the image is downloaded directly from that server by your browser.  That server may log your IP address and browser details, as any web server might.</li>
                        <li>The site uses <a href="https://www.goatcounter.com/" target="_blank">GoatCounter</a> for privacy-friendly analytics.</li>
                    </ul>
                </p>
                <p>
                    If you have any questions about privacy, please <a href="#" id="githubIssueLink2" target="_blank">raise a GitHub issue</a>.
                </p>
            </details>
        </div>

        <div id="footer"></div>
        <script src="/js/site/footer.js"></script>

    </div>

</body>

<!-- Programmer Javascript -->
<script src="/js/prog/programmer.js"></script>

<script>
// On page load, open details if hash matches
if (window.location.hash) {
  const target = document.querySelector(window.location.hash);
  if (target && target.tagName === 'DETAILS') {
    target.open = true;
  }
}

// Handle hash changes (if user clicks another link)
window.addEventListener('hashchange', () => {
  const target = document.querySelector(window.location.hash);
  if (target && target.tagName === 'DETAILS') {
    target.open = true;
  }
});
</script>

<script data-goatcounter="https://onerom-site.analytics.piers.rocks/count" async src="//onerom-site.analytics.piers.rocks/count.js"></script>

</html>